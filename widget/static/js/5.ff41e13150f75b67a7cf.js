webpackJsonp([5],{"1m/5":function(t,e){},PNES:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=i("tyqc"),a=i("0EwI"),s={mounted:function(){console.log(this.replyname),console.log(this.forumid)},props:{replytarget:Number,forumid:Number,replyname:String},data:function(){return{content:"",root:"http://192.168.43.129:8080/"}},methods:{close:function(){this.$emit("changeCommentShow")},handleSend:function(){var t=this,e=this.$cookies.get("CUR_USERINFO"),i=e.userid,n=(e.username,{forumid:this.forumid,userid:i,content:this.content,beforereplyid:Number(this.replytarget),replyname:this.replyname});this.$ajax.post({url:this.root+"reply/addreply",data:n}).then(function(e){e.status&&(t.close(),t.$parent.initReply())})}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"comment-container"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"comment-txt",attrs:{placeholder:"回复"+t.replyname},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}}),t._v(" "),i("div",{staticClass:"action-container"},[i("button",{staticClass:"mui-btn",attrs:{type:"button"},on:{click:t.close}},[t._v("取消")]),t._v(" "),i("span",{staticClass:"send",on:{click:function(e){return t.handleSend()}}},[t._v("发送")])])])},staticRenderFns:[]};var o=i("VU/8")(s,r,!1,function(t){i("TD2t")},"data-v-34f5c144",null).exports,u={components:{CommentDetail:o},props:{replyData:Array},name:"Detail",watch:{replyData:function(t){this.init()}},mounted:function(){this.init()},computed:{userid:function(){return this.$cookies.get("CUR_USERINFO").userid}},data:function(){return{commentShow:!1,temp:"",replytarget:"",listData:[],root:"http://192.168.43.129:8080/"}},methods:{init:function(){this.listData=this.setGridDataFromTree([],this.replyData,"")},setGridDataFromTree:function(t,e){var i=this;if(Array.isArray(e)&&e.length>0)return e.forEach(function(e){t.push(e),void 0===e.child||i.setGridDataFromTree(t,e.child)}),t},func:function(t){return this.temp=t,t.userid},publishCom:function(t,e){console.log(t),this.$emit("showDialog",t,e),this.replytarget=t},deleteCom:function(t){var e=this;mui.confirm("确认删除该评论？","删除",["否","是"],function(i){1===i.index&&e.$ajax.post({url:e.root+"reply/deleteReply",data:{replyid:t}}).then(function(t){t.status&&e.$parent.initReply()})})},changeCommentShow:function(){this.commentShow=!1}}},c={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[t._l(this.listData,function(e,n){return i("div",{key:n,staticClass:"reply-child-item"},[i("span",{staticClass:"detail-title"},[t._v(t._s(e.username)+"  回复  "+t._s(e.replyname))]),t._v(" "),i("div",{staticClass:"reply-container"},[i("p",[t._v(t._s(e.content))]),t._v(" "),i("span",{staticClass:"mui-icon mui-icon-chatboxes",on:{click:function(i){return t.publishCom(e.replyid,e.username)}}}),t._v(" "),e.userid==t.userid?i("span",{staticClass:"mui-icon mui-icon-trash",on:{click:function(i){return t.deleteCom(e.replyid)}}}):t._e()])])}),t._v(" "),t.commentShow?i("CommentDetail",{attrs:{replytarget:t.replytarget},on:{changeCommentShow:t.changeCommentShow}}):t._e()],2)},staticRenderFns:[]};var l=i("VU/8")(u,c,!1,function(t){i("1m/5")},"data-v-9a5b9d42",null).exports,m=i("+pfy"),d={components:{Header:n.a,Detail:l,CommentDetail:o,Loading:a.a,Nothing:m.a},mounted:function(){this.init(),this.initReply(),this.initPraise()},data:function(){return{commentShow:!1,targtreplyid:"",reply:[],replyData:"",root:"http://192.168.43.129:8080/",forum:{forum:{},userinfo:{}},replyname:"123",zanobj:{},loading:!1}},computed:{forumid:function(){return this.$route.query.forumid},forumuserid:function(){return this.$cookies.get("CUR_USERINFO").userid}},methods:{changeCommentShow:function(){this.commentShow=!1},publishCom:function(t,e){console.log(t),this.targtreplyid=t||null,this.replyname=e,this.commentShow=!0},init:function(){var t=this;this.loading=!0,this.$ajax.post({url:this.root+"forum/selectdetail",data:{forumid:Number(this.forumid)}}).then(function(e){t.loading=!1,e.status&&(t.forum=e.object)})},treeObj:function(t){t.map(function(e){null!=e.beforereplyid&&t.map(function(t){e.beforereplyid===t.replyid&&(t.child||(t.child=[]),t.child.push(e),t.child=t.child)})}),this.replyData=t.filter(function(t){return null==t.beforereplyid})},initReply:function(){var t=this;this.loading=!0,this.$ajax.post({url:this.root+"reply/getReply",data:{forumid:Number(this.forumid)}}).then(function(e){t.loading=!1,e.status&&(t.reply=e.result,t.treeObj(t.reply))})},initPraise:function(){var t=this;this.loading=!0,this.$ajax.post({url:this.root+"praise/getCount",data:{forumid:Number(this.forumid),userid:this.forumuserid}}).then(function(e){t.loading=!1,e.status&&(t.zanobj=e.object)})},deleteCom:function(t){var e=this;mui.confirm("确认删除该评论？","删除",["否","是"],function(i){1===i.index&&e.$ajax.post({url:e.root+"reply/deleteReply",data:{replyid:t}}).then(function(t){t.status&&e.initReply()})})},toZan:function(t){var e=this,i=this.$cookies.get("CUR_USERINFO").userid;this.$ajax.post({url:this.root+"praise/insertpraise",data:{userid:i,forumid:t}}).then(function(t){t.status&&e.initPraise()})},toDeleteZan:function(t){var e=this,i=this.$cookies.get("CUR_USERINFO").userid;this.$ajax.post({url:this.root+"praise/cancelZan",data:{userid:i,forumid:t}}).then(function(t){t.status&&e.initPraise()})}}},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("Header",[t._v("帖子详情")]),t._v(" "),t.loading?i("Loading"):t._e(),t._v(" "),t.loading?t._e():i("div",{staticClass:"mui-card detail"},[i("div",{staticClass:"mui-card-header detail-header"},[i("img",{staticClass:"user-avatar",attrs:{src:t.forum.userinfo.avatar}}),t._v(" "),i("div",[i("span",{staticClass:"author-span"},[t._v(t._s(t.forum.userinfo.username))]),t._v(" "),i("p",[t._v(t._s(t._f("format")(t.forum.forum.forumtime)))])])]),t._v(" "),i("div",{staticClass:"mui-card-content"},[i("span",{staticClass:"detail-title"},[t._v("["+t._s(t.forum.forum.forumtitle)+"]")]),t._v(" "),i("p",[t._v(t._s(t.forum.forum.forumcontent))]),t._v(" "),i("div",{staticClass:"img-container"},t._l(t.forum.forumpictureList,function(t,e){return i("img",{directives:[{name:"show",rawName:"v-show",value:t.picture,expression:"img.picture"}],key:t.key,staticClass:"des-img",attrs:{src:t.picture}})}),0)]),t._v(" "),i("div",{staticClass:"mui-card-footer"},[i("span",[t._v("分享")]),t._v(" "),i("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icon-qq"}})]),t._v(" "),i("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icon-weixin"}})]),t._v(" "),i("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icon-pengyouquan"}})])])]),t._v(" "),i("div",{staticClass:"mui-card reply"},[i("div",{staticClass:"mui-card-header"},[i("span",{staticClass:"reply-title"},[t._v("评论  "+t._s(t.reply.length))]),t._v(" "),i("span",{staticClass:"zan-title"},[t._v("赞   "+t._s(t.zanobj.count))])]),t._v(" "),i("div",{staticClass:"mui-card-content reply-container"},[t._l(t.replyData,function(e,n){return i("div",{key:n,staticClass:"item-container"},[i("img",{staticClass:"user-avatar",attrs:{src:e.avatar}}),t._v(" "),i("div",{staticStyle:{width:"100%"}},[i("span",[t._v(t._s(e.username))]),t._v(" "),i("div",{staticStyle:{display:"flex"}},[i("p",[t._v(t._s(e.content))]),t._v(" "),i("span",{staticClass:"mui-icon mui-icon-chatboxes",staticStyle:{"margin-left":"5px"},on:{click:function(i){return t.publishCom(e.replyid,e.username)}}}),t._v(" "),e.userid==t.forumuserid?i("span",{staticClass:"mui-icon mui-icon-trash",on:{click:function(i){return t.deleteCom(e.replyid)}}}):t._e()]),t._v(" "),i("div",{staticClass:"reply-child"},[i("Detail",{attrs:{replyData:e.child},on:{showDialog:t.publishCom}})],1),t._v(" "),i("p",[t._v(t._s(t._f("format")(e.replytime)))])])])}),t._v(" "),this.replyData.length?t._e():i("Nothing")],2)]),t._v(" "),i("div",{staticClass:"footer"},[i("div",{staticClass:"footer-item",on:{click:function(e){return t.publishCom("",t.forum.userinfo.username)}}},[i("span",{staticClass:"mui-icon mui-icon-chatboxes"}),t._v(" "),i("span",[t._v("评论")])]),t._v(" "),t.zanobj.isZan?t._e():i("div",{staticClass:"footer-item",on:{click:function(e){return t.toZan(t.forum.forumid)}}},[i("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icon-zan1"}})]),t._v(" "),i("span",[t._v("点赞")])]),t._v(" "),t.zanobj.isZan?i("div",{staticClass:"footer-item",on:{click:function(e){return t.toDeleteZan(t.forum.forumid)}}},[i("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icon-zan"}})]),t._v(" "),i("span",[t._v("取消赞")])]):t._e()]),t._v(" "),this.commentShow?i("CommentDetail",{attrs:{replytarget:t.targtreplyid,replyname:t.replyname,forumid:t.forum.forumid},on:{changeCommentShow:t.changeCommentShow}}):t._e()],1)},staticRenderFns:[]};var p=i("VU/8")(d,h,!1,function(t){i("uAgU")},"data-v-866b7ed6",null);e.default=p.exports},TD2t:function(t,e){},uAgU:function(t,e){}});
//# sourceMappingURL=5.ff41e13150f75b67a7cf.js.map