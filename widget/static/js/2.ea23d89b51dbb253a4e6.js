webpackJsonp([2],{"+pfy":function(t,i,e){"use strict";var n={render:function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"nothing"},[i("svg",{staticClass:"icon icon-none",attrs:{"aria-hidden":"true"}},[i("use",{attrs:{"xlink:href":"#icon-apptubiao-"}})]),this._v(" "),i("span",[this._v("这里空空如也~~~")])])},staticRenderFns:[]};var a=e("VU/8")(null,n,!1,function(t){e("gLA0")},"data-v-79b1178a",null);i.a=a.exports},"935M":function(t,i){},I465:function(t,i){},PNES:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=e("tyqc"),a=e("0EwI"),s={mounted:function(){console.log(this.replyname),console.log(this.forumid)},props:{replytarget:Number,forumid:Number,replyname:String},data:function(){return{content:"",root:"http://192.168.43.129:8080/"}},methods:{close:function(){this.$emit("changeCommentShow")},handleSend:function(){var t=this,i=this.$cookies.get("CUR_USERINFO"),e=i.userid,n=i.username,a={forumid:this.forumid,userid:e,username:n,content:this.content,beforereplyid:Number(this.replytarget),replyname:this.replyname,avatar:localStorage.getItem("avatar")};this.$ajax.post({url:this.root+"reply/addreply",data:a}).then(function(i){i.status&&(t.close(),t.$parent.initReply())})}}},r={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"comment-container"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"comment-txt",attrs:{placeholder:"回复"+t.replyname},domProps:{value:t.content},on:{input:function(i){i.target.composing||(t.content=i.target.value)}}}),t._v(" "),e("div",{staticClass:"action-container"},[e("button",{staticClass:"mui-btn",attrs:{type:"button"},on:{click:t.close}},[t._v("取消")]),t._v(" "),e("span",{staticClass:"send",on:{click:function(i){return t.handleSend()}}},[t._v("发送")])])])},staticRenderFns:[]};var o=e("VU/8")(s,r,!1,function(t){e("lyZK")},"data-v-55a258bc",null).exports,u={components:{CommentDetail:o},props:{replyData:Array},name:"Detail",watch:{replyData:function(t){this.init()}},mounted:function(){this.init()},computed:{userid:function(){return this.$cookies.get("CUR_USERINFO").userid}},data:function(){return{commentShow:!1,temp:"",replytarget:"",listData:[],root:"http://192.168.43.129:8080/"}},methods:{init:function(){this.listData=this.setGridDataFromTree([],this.replyData,"")},setGridDataFromTree:function(t,i){var e=this;if(Array.isArray(i)&&i.length>0)return i.forEach(function(i){t.push(i),void 0===i.child||e.setGridDataFromTree(t,i.child)}),t},func:function(t){return this.temp=t,t.userid},publishCom:function(t,i){this.$emit("showDialog",t,i)},deleteCom:function(t){var i=this;mui.confirm("确认删除该评论？","删除",["否","是"],function(e){1===e.index&&i.$ajax.post({url:i.root+"reply/deleteReply",data:{replyid:t}}).then(function(t){t.status&&i.$parent.initReply()})})},changeCommentShow:function(){this.commentShow=!1}}},c={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[t._l(this.listData,function(i,n){return e("div",{key:n,staticClass:"reply-child-item"},[e("span",{staticClass:"detail-title"},[t._v(t._s(i.username)+"  回复  "+t._s(i.replyname))]),t._v(" "),e("div",{staticClass:"reply-container"},[e("p",[t._v(t._s(i.content))]),t._v(" "),e("span",{staticClass:"mui-icon mui-icon-chatboxes",on:{click:function(e){return t.publishCom(i.replyid,i.username)}}}),t._v(" "),i.userid==t.userid?e("span",{staticClass:"mui-icon mui-icon-trash",on:{click:function(e){return t.deleteCom(i.replyid)}}}):t._e()])])}),t._v(" "),t.commentShow?e("CommentDetail",{attrs:{replytarget:t.replytarget},on:{changeCommentShow:t.changeCommentShow}}):t._e()],2)},staticRenderFns:[]};var l=e("VU/8")(u,c,!1,function(t){e("935M")},"data-v-17ed16e0",null).exports,d=e("+pfy"),m={components:{Header:n.a,Detail:l,CommentDetail:o,Loading:a.a,Nothing:d.a},mounted:function(){this.init(),this.initReply(),this.initPraise()},data:function(){return{commentShow:!1,targtreplyid:"",reply:[],replyData:"",root:"http://192.168.43.129:8080/",forum:{forum:{},userinfo:{}},replyname:"123",zanobj:{},loading:!1}},computed:{forumid:function(){return this.$route.query.forumid},forumuserid:function(){return this.$cookies.get("CUR_USERINFO").userid}},methods:{changeCommentShow:function(){this.commentShow=!1},publishCom:function(t,i){this.targtreplyid=t||null,this.replyname=i,this.commentShow=!0},init:function(){var t=this;this.loading=!0,this.$ajax.post({url:this.root+"forum/selectdetail",data:{forumid:Number(this.forumid)}}).then(function(i){t.loading=!1,i.status&&(t.forum=i.object)})},treeObj:function(t){t.map(function(i){null!=i.beforereplyid&&t.map(function(t){i.beforereplyid===t.replyid&&(t.child||(t.child=[]),t.child.push(i),t.child=t.child)})}),this.replyData=t.filter(function(t){return null==t.beforereplyid})},initReply:function(){var t=this;this.loading=!0,this.$ajax.post({url:this.root+"reply/getReply",data:{forumid:Number(this.forumid)}}).then(function(i){t.loading=!1,i.status&&(t.reply=i.result,t.treeObj(t.reply))})},initPraise:function(){var t=this;this.loading=!0,this.$ajax.post({url:this.root+"praise/getCount",data:{forumid:Number(this.forumid),userid:this.forumuserid}}).then(function(i){t.loading=!1,i.status&&(t.zanobj=i.object)})},deleteCom:function(t){var i=this;mui.confirm("确认删除该评论？","删除",["否","是"],function(e){1===e.index&&i.$ajax.post({url:i.root+"reply/deleteReply",data:{replyid:t}}).then(function(t){t.status&&i.initReply()})})},toZan:function(t){var i=this,e=this.$cookies.get("CUR_USERINFO").userid;this.$ajax.post({url:this.root+"praise/insertpraise",data:{userid:e,forumid:t}}).then(function(t){t.status&&i.initPraise()})},toDeleteZan:function(t){var i=this,e=this.$cookies.get("CUR_USERINFO").userid;this.$ajax.post({url:this.root+"praise/cancelZan",data:{userid:e,forumid:t}}).then(function(t){t.status&&i.initPraise()})}}},h={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("Header",[t._v("帖子详情")]),t._v(" "),e("div",{staticClass:"mui-card detail"},[e("div",{staticClass:"mui-card-header detail-header"},[e("img",{staticClass:"user-avatar",attrs:{src:t.forum.userinfo.avatar}}),t._v(" "),e("div",[e("span",{staticClass:"author-span"},[t._v(t._s(t.forum.userinfo.username))]),t._v(" "),e("p",[t._v(t._s(t._f("format")(t.forum.forum.forumtime)))])])]),t._v(" "),e("div",{staticClass:"mui-card-content"},[e("span",{staticClass:"detail-title"},[t._v("["+t._s(t.forum.forum.forumtitle)+"]")]),t._v(" "),e("p",[t._v(t._s(t.forum.forum.forumcontent))]),t._v(" "),e("div",{staticClass:"img-container"},t._l(t.forum.forumpictureList,function(t,i){return e("img",{key:t.key,staticClass:"des-img",attrs:{src:t.picture}})}),0)]),t._v(" "),e("div",{staticClass:"mui-card-footer"},[e("span",[t._v("分享")]),t._v(" "),e("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-qq"}})]),t._v(" "),e("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-weixin"}})]),t._v(" "),e("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-pengyouquan"}})])])]),t._v(" "),e("div",{staticClass:"mui-card reply"},[e("div",{staticClass:"mui-card-header"},[e("span",{staticClass:"reply-title"},[t._v("评论  "+t._s(t.reply.length))]),t._v(" "),e("span",{staticClass:"zan-title"},[t._v("赞   "+t._s(t.zanobj.count))])]),t._v(" "),e("div",{staticClass:"mui-card-content reply-container"},[t._l(t.replyData,function(i,n){return e("div",{key:n,staticClass:"item-container"},[e("img",{staticClass:"user-avatar",attrs:{src:i.avatar}}),t._v(" "),e("div",{staticStyle:{width:"100%"}},[e("span",[t._v(t._s(i.username))]),t._v(" "),e("div",{staticStyle:{display:"flex"}},[e("p",[t._v(t._s(i.content))]),t._v(" "),e("span",{staticClass:"mui-icon mui-icon-chatboxes",staticStyle:{"margin-left":"5px"},on:{click:function(e){return t.publishCom(i.replyid,i.username)}}}),t._v(" "),i.userid==t.forumuserid?e("span",{staticClass:"mui-icon mui-icon-trash",on:{click:function(e){return t.deleteCom(i.replyid)}}}):t._e()]),t._v(" "),e("div",{staticClass:"reply-child"},[e("Detail",{attrs:{replyData:i.child},on:{showDialog:t.publishCom}})],1),t._v(" "),e("p",[t._v(t._s(t._f("format")(i.replytime)))])])])}),t._v(" "),this.replyData.length?t._e():e("Nothing")],2)]),t._v(" "),e("div",{staticClass:"footer"},[e("div",{staticClass:"footer-item",on:{click:function(i){return t.publishCom("",t.forum.userinfo.username)}}},[e("span",{staticClass:"mui-icon mui-icon-chatboxes"}),t._v(" "),e("span",[t._v("评论")])]),t._v(" "),t.zanobj.isZan?t._e():e("div",{staticClass:"footer-item",on:{click:function(i){return t.toZan(t.forum.forumid)}}},[e("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-zan1"}})]),t._v(" "),e("span",[t._v("点赞")])]),t._v(" "),t.zanobj.isZan?e("div",{staticClass:"footer-item",on:{click:function(i){return t.toDeleteZan(t.forum.forumid)}}},[e("svg",{staticClass:"icon",attrs:{"aria-hidden":"true"}},[e("use",{attrs:{"xlink:href":"#icon-zan"}})]),t._v(" "),e("span",[t._v("取消赞")])]):t._e()]),t._v(" "),this.commentShow?e("CommentDetail",{attrs:{replytarget:t.targtreplyid,replyname:t.replyname,forumid:t.forum.forumid},on:{changeCommentShow:t.changeCommentShow}}):t._e(),t._v(" "),t.loading?e("Loading"):t._e()],1)},staticRenderFns:[]};var f=e("VU/8")(m,h,!1,function(t){e("I465")},"data-v-1732829b",null);i.default=f.exports},gLA0:function(t,i){},lyZK:function(t,i){}});
//# sourceMappingURL=2.ea23d89b51dbb253a4e6.js.map